# ä» NSIS è¿ç§»åˆ° Inno Setup

## âœ… å·²å®Œæˆçš„æ”¹åŠ¨

### 1. æ–°å¢æ–‡ä»¶
- `desktop/installer.iss` - Inno Setup å®‰è£…è„šæœ¬
- `desktop/build-innosetup.bat` - æ–°çš„æ„å»ºè„šæœ¬
- `desktop/INNOSETUP_GUIDE.md` - ä½¿ç”¨æ–‡æ¡£

### 2. ä¿®æ”¹æ–‡ä»¶
- `desktop/package.json`
  - ä¿®æ”¹ `scripts.build` â†’ ä½¿ç”¨ Inno Setup
  - ç§»é™¤ NSIS é…ç½®
  - electron-builder æ”¹ä¸º `--dir` æ¨¡å¼

- `desktop/src/main.js`
  - ä¼˜åŒ–æµè§ˆå™¨åŠ è½½é€»è¾‘
  - æ£€æŸ¥ `.installed` æ ‡è®°ï¼Œè·³è¿‡å·²å®‰è£…çš„æµè§ˆå™¨

### 3. å¼ƒç”¨æ–‡ä»¶ï¼ˆå¯åˆ é™¤ï¼‰
- `desktop/build-installer-ADMIN.bat` âŒï¼ˆå·²è¢« `build-innosetup.bat` æ›¿ä»£ï¼‰
- `desktop/build-installer.bat` âŒï¼ˆå·²è¢« `build-innosetup.bat` æ›¿ä»£ï¼‰
- `desktop/build/installer.nsh` âŒï¼ˆInno Setup ä¸éœ€è¦ NSIS è„šæœ¬ï¼‰

---

## ğŸš€ å¼€å§‹ä½¿ç”¨æ–°æ–¹æ¡ˆ

### æ­¥éª¤ 1ï¼šå®‰è£… Inno Setup

ä¸‹è½½å¹¶å®‰è£… [Inno Setup 6](https://jrsoftware.org/isdl.php)

æˆ–ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼š
```bash
choco install innosetup
# æˆ–
scoop install innosetup
```

### æ­¥éª¤ 2ï¼šå‡†å¤‡æµè§ˆå™¨ï¼ˆå¯é€‰ä½†æ¨èï¼‰

```bash
cd desktop
prepare-browsers-zip.bat
```

### æ­¥éª¤ 3ï¼šæ„å»ºå®‰è£…åŒ…

**ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ**ï¼š
```bash
cd desktop
build-innosetup.bat
```

è¾“å‡ºæ–‡ä»¶ï¼š`desktop/dist/SynapseAutomation-Setup-0.1.0.exe`

---

## ğŸ”„ ä¸»è¦å˜åŒ–

| é¡¹ç›® | æ—§æ–¹æ¡ˆï¼ˆNSISï¼‰ | æ–°æ–¹æ¡ˆï¼ˆInno Setupï¼‰ |
|------|---------------|---------------------|
| **æ„å»ºè„šæœ¬** | `build-installer-ADMIN.bat` | `build-innosetup.bat` |
| **å®‰è£…è„šæœ¬** | `build/installer.nsh` | `installer.iss` |
| **æµè§ˆå™¨è§£å‹** | é¦–æ¬¡è¿è¡Œæ—¶ | **å®‰è£…æ—¶** |
| **æ„å»ºå‘½ä»¤** | `npm run build` | `npm run build` |
| **é¦–æ¬¡å¯åŠ¨** | ç­‰å¾… 5-10 åˆ†é’Ÿ | **å³å¼€å³ç”¨** |

---

## ğŸ“¦ æ–°å®‰è£…æµç¨‹

### å®‰è£…æ—¶ï¼ˆInno Setupï¼‰
1. ç”¨æˆ·è¿è¡Œ `SynapseAutomation-Setup-0.1.0.exe`
2. é€‰æ‹©å®‰è£…è·¯å¾„
3. **è‡ªåŠ¨è§£å‹æµè§ˆå™¨åˆ° AppData**
4. åˆ›å»ºå¿«æ·æ–¹å¼
5. å®‰è£…å®Œæˆ

### é¦–æ¬¡å¯åŠ¨ï¼ˆElectronï¼‰
1. æ£€æŸ¥ `%APPDATA%\synapseautomation-desktop\playwright-browsers\.installed`
2. å¦‚æœå­˜åœ¨ â†’ **ç›´æ¥ä½¿ç”¨é¢„è£…æµè§ˆå™¨ï¼Œç§’å¯åŠ¨**
3. å¦‚æœä¸å­˜åœ¨ â†’ å›é€€åˆ°ä¸‹è½½æµç¨‹ï¼ˆå…¼å®¹æ—§ç‰ˆï¼‰

---

## ğŸ¯ ä¼˜åŠ¿

1. **ç”¨æˆ·ä½“éªŒå¤§å¹…æå‡**
   - âœ… é¦–æ¬¡å¯åŠ¨æ— éœ€ç­‰å¾…ä¸‹è½½
   - âœ… ç‚¹å¼€å°±èƒ½ç”¨

2. **å®‰è£…åŒ…è´¨é‡æ›´é«˜**
   - âœ… ä½¿ç”¨ LZMA2 æœ€å¤§å‹ç¼©
   - âœ… æ”¯æŒä¸­è‹±æ–‡åŒè¯­å®‰è£…ç•Œé¢
   - âœ… æ›´çµæ´»çš„è‡ªå®šä¹‰é€‰é¡¹

3. **ç»´æŠ¤æ›´ç®€å•**
   - âœ… Inno Setup è„šæœ¬æ¯” NSIS æ›´æ˜“è¯»
   - âœ… æ›´å¥½çš„é”™è¯¯æç¤º
   - âœ… æ›´æ´»è·ƒçš„ç¤¾åŒºæ”¯æŒ

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæ‰¾ä¸åˆ° `iscc` å‘½ä»¤

**ç—‡çŠ¶**ï¼š
```
[é”™è¯¯] æœªæ‰¾åˆ° Inno Setup ç¼–è¯‘å™¨ (iscc.exe)
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ç¡®ä¿å·²å®‰è£… Inno Setup 6
2. æ·»åŠ åˆ° PATHï¼š`C:\Program Files (x86)\Inno Setup 6`
3. é‡å¯å‘½ä»¤è¡Œ

---

### é—®é¢˜ 2ï¼šæ„å»ºå¤±è´¥ - æƒé™ä¸è¶³

**ç—‡çŠ¶**ï¼š
```
[é”™è¯¯] å¿…é¡»ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œï¼
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
å³é”® `build-innosetup.bat` â†’ **ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ**

---

### é—®é¢˜ 3ï¼šå®‰è£…æ—¶æµè§ˆå™¨è§£å‹å¤±è´¥

**ç—‡çŠ¶**ï¼š
å®‰è£…è¿‡ç¨‹æ˜¾ç¤º "æµè§ˆå™¨è§£å‹å¤±è´¥"

**å½±å“**ï¼š
ä¸å½±å“åº”ç”¨å®‰è£…ï¼Œé¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½æµè§ˆå™¨

**æ ¹æœ¬è§£å†³**ï¼š
1. ç¡®ä¿ `resources/browsers-zip/chrome-for-testing.zip` å­˜åœ¨
2. è¿è¡Œ `prepare-browsers-zip.bat` é‡æ–°å‡†å¤‡
3. é‡æ–°æ„å»ºå®‰è£…åŒ…

---

## ğŸ“ æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] æ„å»ºè„šæœ¬è¿è¡ŒæˆåŠŸ
- [ ] ç”Ÿæˆ `dist/SynapseAutomation-Setup-0.1.0.exe`
- [ ] å®‰è£…åŒ…å¯ä»¥è¿è¡Œ
- [ ] å®‰è£…æ—¶æ˜¾ç¤ºæµè§ˆå™¨è§£å‹è¿›åº¦
- [ ] é¦–æ¬¡å¯åŠ¨æ— éœ€ç­‰å¾…ä¸‹è½½
- [ ] åº”ç”¨åŠŸèƒ½æ­£å¸¸

---

## ğŸ”„ å›é€€åˆ°æ—§æ–¹æ¡ˆ

å¦‚æœéœ€è¦ä¸´æ—¶å›é€€åˆ° NSISï¼š

1. æ¢å¤ `package.json` ä¸­çš„ NSIS é…ç½®
2. ä½¿ç”¨æ—§çš„ `build-installer-ADMIN.bat`
3. è¿è¡Œ `npm run build`

ä½†å»ºè®®ä¿æŒæ–°æ–¹æ¡ˆï¼Œå› ä¸ºç”¨æˆ·ä½“éªŒæ›´å¥½ã€‚

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»ï¼š
- é¡¹ç›® Issues: GitHub Issues
- æŠ€æœ¯æ”¯æŒ: support@synapseautomation.com
