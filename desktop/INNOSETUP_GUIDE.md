# Inno Setup æ‰“åŒ…è¯´æ˜

## ğŸ“¦ æ–°çš„æ‰“åŒ…æ¶æ„

æˆ‘ä»¬å·²å°†æ‰“åŒ…æ–¹å¼ä» **electron-builder NSIS** è¿ç§»åˆ° **Inno Setup**ï¼Œä»¥å®ç°ï¼š
- âœ… **å®‰è£…æ—¶è§£å‹æµè§ˆå™¨**ï¼ˆè€Œéé¦–æ¬¡è¿è¡Œï¼‰
- âœ… **å³å¼€å³ç”¨**ï¼Œæ— éœ€ç­‰å¾…ä¸‹è½½
- âœ… **æ›´çµæ´»çš„å®‰è£…é…ç½®**

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£… Inno Setup

#### æ–¹å¼ 1ï¼šå®˜ç½‘ä¸‹è½½ï¼ˆæ¨èï¼‰
è®¿é—® [Inno Setup å®˜ç½‘](https://jrsoftware.org/isdl.php) ä¸‹è½½æœ€æ–°ç‰ˆï¼ˆéœ€è¦ 6.0+ï¼‰

#### æ–¹å¼ 2ï¼šä½¿ç”¨ Chocolatey
```bash
choco install innosetup
```

#### æ–¹å¼ 3ï¼šä½¿ç”¨ Scoop
```bash
scoop install innosetup
```

å®‰è£…å®Œæˆåï¼Œç¡®ä¿ `iscc.exe` åœ¨ç³»ç»Ÿ PATH ä¸­ï¼š
```bash
where iscc
```

---

### 2. å‡†å¤‡æµè§ˆå™¨æ–‡ä»¶

è¿è¡Œæµè§ˆå™¨å‡†å¤‡è„šæœ¬ï¼ˆå¯é€‰ï¼Œæ¨èï¼‰ï¼š
```bash
cd desktop
prepare-browsers-zip.bat
```

è¿™å°†å‹ç¼© Chrome for Testing åˆ° `resources/browsers-zip/chrome-for-testing.zip`

> **æ³¨æ„**ï¼šå¦‚æœè·³è¿‡æ­¤æ­¥éª¤ï¼Œå®‰è£…åŒ…å°†ä¸åŒ…å«é¢„è£…æµè§ˆå™¨ï¼Œç”¨æˆ·é¦–æ¬¡å¯åŠ¨æ—¶éœ€ç­‰å¾…ä¸‹è½½ã€‚

---

### 3. æ„å»ºå®‰è£…åŒ…

**ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ**æ„å»ºè„šæœ¬ï¼š

```bash
cd desktop
build-innosetup.bat
```

> âš ï¸ **å¿…é¡»ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ**ï¼ˆElectron éœ€è¦ç¬¦å·é“¾æ¥æƒé™ï¼‰

æ„å»ºè¿‡ç¨‹åŒ…æ‹¬ï¼š
1. æ£€æŸ¥ Inno Setup æ˜¯å¦å®‰è£…
2. æ¸…ç†ç¼“å­˜
3. å®‰è£… Node.js ä¾èµ–
4. å‡†å¤‡æµè§ˆå™¨ ZIP æ–‡ä»¶
5. å‡†å¤‡èµ„æºæ–‡ä»¶ï¼ˆbackendã€frontendï¼‰
6. æ„å»º Electron åº”ç”¨ï¼ˆelectron-builder --dirï¼‰
7. ä½¿ç”¨ Inno Setup ç¼–è¯‘å®‰è£…ç¨‹åº

**é¢„è®¡è€—æ—¶**ï¼š10-20 åˆ†é’Ÿï¼ˆå–å†³äºç¡¬ä»¶å’Œç½‘ç»œï¼‰

---

## ğŸ“‚ è¾“å‡ºæ–‡ä»¶

æ„å»ºæˆåŠŸåï¼Œåœ¨ `desktop/dist/` ç›®å½•ä¸‹ä¼šç”Ÿæˆï¼š

```
dist/
â”œâ”€â”€ win-unpacked/              # Electron åº”ç”¨ï¼ˆæœªæ‰“åŒ…ï¼‰
â”‚   â””â”€â”€ SynapseAutomation.exe
â””â”€â”€ SynapseAutomation-Setup-0.1.0.exe  # Inno Setup å®‰è£…ç¨‹åº
```

---

## ğŸ¯ å®‰è£…æµç¨‹

ç”¨æˆ·å®‰è£…æ—¶çš„æµç¨‹ï¼š

1. **è¿è¡Œå®‰è£…ç¨‹åº** â†’ `SynapseAutomation-Setup-0.1.0.exe`
2. **é€‰æ‹©å®‰è£…è·¯å¾„**
3. **è‡ªåŠ¨è§£å‹æµè§ˆå™¨**ï¼ˆå¦‚æœ ZIP æ–‡ä»¶å­˜åœ¨ï¼‰
   - æ˜¾ç¤ºè¿›åº¦ï¼š`æ­£åœ¨è§£å‹ Chrome for Testing...`
   - è§£å‹åˆ°ï¼š`%APPDATA%\synapseautomation-desktop\playwright-browsers\`
4. **åˆ›å»ºæ¡Œé¢å¿«æ·æ–¹å¼**ï¼ˆå¯é€‰ï¼‰
5. **å®Œæˆå®‰è£…**

> âœ… **å®‰è£…å®Œæˆåï¼Œé¦–æ¬¡å¯åŠ¨æ— éœ€ç­‰å¾…ä¸‹è½½æµè§ˆå™¨**

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### Inno Setup è„šæœ¬ï¼š`installer.iss`

æ ¸å¿ƒé…ç½®ï¼š
- **å‹ç¼©**ï¼š`lzma2/max`ï¼ˆæœ€å¤§å‹ç¼©ç‡ï¼‰
- **æ¶æ„**ï¼šä»… x64
- **æƒé™**ï¼šç®¡ç†å‘˜ï¼ˆå®‰è£…æµè§ˆå™¨åˆ° AppData éœ€è¦ï¼‰
- **è¯­è¨€**ï¼šä¸­æ–‡ + è‹±æ–‡

### å®‰è£…æ—¶æµè§ˆå™¨è§£å‹

åœ¨ `[Code]` æ®µä¸­ä½¿ç”¨ PowerShell è§£å‹ï¼š
```pascal
ExtractZipFile(ZipPath, TargetPath)
  â†’ powershell Expand-Archive
```

### Electron å¯åŠ¨ä¼˜åŒ–

ä¿®æ”¹äº† `main.js`ï¼š
- æ£€æŸ¥ `.installed` æ ‡è®°æ–‡ä»¶
- å¦‚æœæµè§ˆå™¨å·²é¢„è£… â†’ è·³è¿‡è§£å‹
- å¦‚æœæµè§ˆå™¨æœªé¢„è£… â†’ å›é€€åˆ°é¦–æ¬¡è§£å‹ï¼ˆå…¼å®¹æ—§ç‰ˆï¼‰

---

## ğŸ› ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹åº”ç”¨ä¿¡æ¯

ç¼–è¾‘ `installer.iss`ï¼š
```pascal
#define MyAppVersion "0.1.0"  ; ä¿®æ”¹ç‰ˆæœ¬å·
#define MyAppPublisher "Your Company"  ; ä¿®æ”¹å‘å¸ƒè€…
```

### ä¿®æ”¹å®‰è£…è·¯å¾„

```pascal
DefaultDirName={autopf}\{#MyAppName}  ; é»˜è®¤ Program Files
; æ”¹ä¸ºç”¨æˆ·ç›®å½•ï¼šDefaultDirName={userpf}\{#MyAppName}
```

### æ·»åŠ è‡ªå®šä¹‰æ–‡ä»¶

åœ¨ `[Files]` æ®µæ·»åŠ ï¼š
```pascal
Source: "path\to\file"; DestDir: "{app}\folder"
```

---

## âŒ ç§»é™¤çš„æ—§æ–‡ä»¶

ä»¥ä¸‹æ–‡ä»¶å·²å¼ƒç”¨ï¼ˆå¯é€‰åˆ é™¤ï¼‰ï¼š
- `build-installer-ADMIN.bat` â†’ å·²è¢« `build-innosetup.bat` æ›¿ä»£
- `build-installer.bat` â†’ å·²è¢« `build-innosetup.bat` æ›¿ä»£
- `desktop/build/installer.nsh` â†’ Inno Setup ä¸å†éœ€è¦ NSIS è„šæœ¬

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. æ‰¾ä¸åˆ° `iscc` å‘½ä»¤
**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ Inno Setup å·²å®‰è£…
- å°† `C:\Program Files (x86)\Inno Setup 6` æ·»åŠ åˆ°ç³»ç»Ÿ PATH
- é‡å¯å‘½ä»¤è¡Œ

### 2. æ„å»ºæ—¶æç¤ºæƒé™ä¸è¶³
**è§£å†³æ–¹æ¡ˆ**ï¼š
- å³é”® `build-innosetup.bat` â†’ **ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ**

### 3. å®‰è£…åŒ…ä½“ç§¯è¿‡å¤§
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æµè§ˆå™¨ ZIP æ–‡ä»¶çº¦ 150-200 MB
- å¦‚éœ€å‡å°ä½“ç§¯ï¼Œå¯ç§»é™¤ `resources/browsers-zip/*.zip`ï¼ˆç”¨æˆ·é¦–æ¬¡å¯åŠ¨æ—¶ä¼šä¸‹è½½ï¼‰

### 4. å®‰è£…æ—¶æµè§ˆå™¨è§£å‹å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ç”¨æˆ·æœ‰ç®¡ç†å‘˜æƒé™
- æ£€æŸ¥ `%APPDATA%` ç›®å½•æ˜¯å¦æœ‰å†™å…¥æƒé™
- é¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨å›é€€åˆ°ä¸‹è½½æµç¨‹

---

## ğŸ“ å¼€å‘ vs ç”Ÿäº§

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```
- ä½¿ç”¨ç³»ç»Ÿæµè§ˆå™¨æˆ– Playwright è‡ªåŠ¨ä¸‹è½½
- å¿«é€Ÿè¿­ä»£

### ç”Ÿäº§æ‰“åŒ…
```bash
build-innosetup.bat
```
- é¢„è£…æµè§ˆå™¨
- ç”¨æˆ·å³å¼€å³ç”¨

---

## ğŸ‰ ä¼˜åŠ¿æ€»ç»“

| ç‰¹æ€§ | æ—§æ–¹æ¡ˆï¼ˆNSISï¼‰ | æ–°æ–¹æ¡ˆï¼ˆInno Setupï¼‰ |
|------|---------------|---------------------|
| æµè§ˆå™¨è§£å‹æ—¶æœº | é¦–æ¬¡è¿è¡Œ | å®‰è£…æ—¶ |
| é¦–æ¬¡å¯åŠ¨é€Ÿåº¦ | éœ€ç­‰å¾… 5-10 åˆ†é’Ÿ | **å³å¼€å³ç”¨** |
| å®‰è£…åŒ…å¤§å° | è¾ƒå° | ç¨å¤§ï¼ˆå«æµè§ˆå™¨ï¼‰ |
| ç”¨æˆ·ä½“éªŒ | â­â­â­ | â­â­â­â­â­ |
| è‡ªå®šä¹‰èƒ½åŠ› | æœ‰é™ | **çµæ´»** |

---

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ Issueï¼š
- GitHub: [SynapseAutomation Issues](https://github.com/your-org/synapseautomation/issues)
- é‚®ç®±: support@synapseautomation.com
