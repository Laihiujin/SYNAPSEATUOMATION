# å¹³å°ç‰¹å®šå…ƒæ•°æ®é€‚é…ç³»ç»Ÿ - å®Œæ•´å®ç°æ–‡æ¡£

## åŠŸèƒ½æ¦‚è¿°

æœ¬ç³»ç»Ÿå®ç°äº†é’ˆå¯¹ä¸åŒçŸ­è§†é¢‘å¹³å°çš„å…ƒæ•°æ®æ ¼å¼é€‚é…ï¼Œè§£å†³äº†å„å¹³å°å‘å¸ƒç•Œé¢å­—æ®µç»“æ„å·®å¼‚çš„é—®é¢˜ã€‚ç³»ç»Ÿæ”¯æŒæ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾åœ¨ä¸åŒå¹³å°é—´çš„æ™ºèƒ½è½¬æ¢å’Œé¢„è§ˆã€‚

---

## 1. é—®é¢˜èƒŒæ™¯

### 1.1 å„å¹³å°å­—æ®µç»“æ„å·®å¼‚

| å¹³å° | å­—æ®µç»“æ„ | è¯´æ˜ |
|------|----------|------|
| **æŠ–éŸ³** | æ ‡é¢˜ + ç®€ä»‹ | ç®€ä»‹æ”¯æŒè¯é¢˜æ ‡ç­¾ï¼ˆ#æ ‡ç­¾ï¼‰ |
| **å¿«æ‰‹** | å•ä¸€æè¿°æ¡† | æ ‡é¢˜+æè¿°+æ ‡ç­¾å…¨éƒ¨åˆå¹¶ |
| **å°çº¢ä¹¦** | æ ‡é¢˜ + æè¿° | æè¿°æ”¯æŒæ¢è¡Œå’Œè¯é¢˜æ ‡ç­¾ |
| **Bç«™** | æ ‡é¢˜ + ç®€ä»‹ + æ ‡ç­¾ | ä¸‰ä¸ªç‹¬ç«‹å­—æ®µ |
| **è§†é¢‘å·** | æè¿° | æè¿°+æ ‡ç­¾åˆå¹¶ï¼Œæ— ç‹¬ç«‹æ ‡é¢˜ |

### 1.2 æ ¸å¿ƒæŒ‘æˆ˜

1. **å­—æ®µæ˜ å°„å¤æ‚**ï¼šåŒæ ·çš„å†…å®¹éœ€è¦æ˜ å°„åˆ°ä¸åŒå¹³å°çš„ä¸åŒå­—æ®µ
2. **æ ¼å¼è½¬æ¢**ï¼šæ ‡ç­¾éœ€è¦æ ¹æ®å¹³å°è‡ªåŠ¨æ·»åŠ æˆ–ç§»é™¤ `#` ç¬¦å·
3. **å†…å®¹åˆå¹¶**ï¼šå¿«æ‰‹ã€è§†é¢‘å·éœ€è¦å°†å¤šä¸ªå­—æ®µåˆå¹¶ä¸ºä¸€ä¸ª
4. **é¢„è§ˆå›°éš¾**ï¼šç”¨æˆ·éš¾ä»¥é¢„åˆ¤å†…å®¹åœ¨å„å¹³å°çš„å®é™…å±•ç¤ºæ•ˆæœ

---

## 2. è§£å†³æ–¹æ¡ˆæ¶æ„

### 2.1 æ•´ä½“æ¶æ„

```
ç”¨æˆ·è¾“å…¥ (é€šç”¨æ ¼å¼)
    â†“
å¹³å°é€‚é…å™¨ (PlatformMetadataAdapter)
    â†“
å¹³å°ç‰¹å®šæ ¼å¼
    â†“
åç«¯ API / å‘å¸ƒæ¥å£
```

### 2.2 æ ¸å¿ƒç»„ä»¶

1. **platform-metadata-adapter.ts** - å¹³å°é€‚é…å™¨å¼•æ“
2. **MaterialMetadataEditor** - å…ƒæ•°æ®ç¼–è¾‘å™¨ï¼ˆå«å¹³å°é¢„è§ˆï¼‰
3. **å‘å¸ƒé€»è¾‘** - é›†æˆé€‚é…å™¨çš„å‘å¸ƒæµç¨‹

---

## 3. å¹³å°é…ç½®è¯¦è§£

### 3.1 é…ç½®ç»“æ„

```typescript
interface PlatformFieldConfig {
    name: string           // å¹³å°åç§°
    code: number          // å¹³å°ä»£ç 
    fields: {             // å­—æ®µé…ç½®
        title?: { ... }
        description?: { ... }
        tags?: { ... }
        combined?: { ... }
    }
    layout: "separate" | "title-description" | "combined" | "title-combined"
}
```

### 3.2 å„å¹³å°è¯¦ç»†é…ç½®

#### æŠ–éŸ³ (Douyin)

**å¸ƒå±€ç±»å‹**ï¼š`title-description`

**å­—æ®µé…ç½®**ï¼š
- **æ ‡é¢˜**ï¼š
  - å¯ç”¨ï¼šâœ…
  - æœ€å¤§é•¿åº¦ï¼š30å­—
  - å ä½ç¬¦ï¼š"å¡«å†™æ ‡é¢˜ï¼Œä¼šæ›´å¤šäººçœ‹åˆ°å“¦~"

- **ç®€ä»‹æè¿°**ï¼š
  - å¯ç”¨ï¼šâœ…
  - æœ€å¤§é•¿åº¦ï¼š2000å­—
  - æ”¯æŒè¯é¢˜æ ‡ç­¾ï¼šâœ…
  - æ”¯æŒæ¢è¡Œï¼šâœ…
  - å ä½ç¬¦ï¼š"æ·»åŠ ä½œå“ç®€ä»‹ #è¯é¢˜"

- **æ ‡ç­¾**ï¼š
  - ç‹¬ç«‹å­—æ®µï¼šâŒ (é›†æˆåœ¨æè¿°ä¸­)

**æ ¼å¼åŒ–è§„åˆ™**ï¼š
```
æ ‡é¢˜ â†’ æ ‡é¢˜å­—æ®µ
æè¿° + #æ ‡ç­¾1 #æ ‡ç­¾2 â†’ ç®€ä»‹å­—æ®µ
```

---

#### å¿«æ‰‹ (Kuaishou)

**å¸ƒå±€ç±»å‹**ï¼š`combined`

**å­—æ®µé…ç½®**ï¼š
- **åˆå¹¶å­—æ®µ**ï¼š
  - å¯ç”¨ï¼šâœ…
  - åŒ…å«æ ‡é¢˜ï¼šâœ…
  - åŒ…å«æè¿°ï¼šâœ…
  - åŒ…å«æ ‡ç­¾ï¼šâœ…
  - å ä½ç¬¦ï¼š"è¯´ç‚¹ä»€ä¹ˆ...è®°å¾—æ·»åŠ è¯é¢˜å“¦ #è¯é¢˜"

**æ ¼å¼åŒ–è§„åˆ™**ï¼š
```
æ ‡é¢˜

æè¿°

#æ ‡ç­¾1 #æ ‡ç­¾2 #æ ‡ç­¾3
```

---

#### å°çº¢ä¹¦ (Xiaohongshu)

**å¸ƒå±€ç±»å‹**ï¼š`title-description`

**å­—æ®µé…ç½®**ï¼š
- **æ ‡é¢˜**ï¼š
  - å¯ç”¨ï¼šâœ…
  - æœ€å¤§é•¿åº¦ï¼š20å­— âš ï¸
  - å ä½ç¬¦ï¼š"å¡«å†™æ ‡é¢˜ä¼šæœ‰æ›´å¤šèµå“¦~"

- **ç¬”è®°æ­£æ–‡**ï¼š
  - å¯ç”¨ï¼šâœ…
  - æœ€å¤§é•¿åº¦ï¼š1000å­—
  - æ”¯æŒè¯é¢˜æ ‡ç­¾ï¼šâœ…
  - æ”¯æŒæ¢è¡Œï¼šâœ…

**æ ¼å¼åŒ–è§„åˆ™**ï¼š
```
æ ‡é¢˜ â†’ æ ‡é¢˜å­—æ®µ (æˆªæ–­è‡³20å­—)
æè¿°
#æ ‡ç­¾1# #æ ‡ç­¾2# â†’ ç¬”è®°æ­£æ–‡
```

---

#### Bç«™ (Bilibili)

**å¸ƒå±€ç±»å‹**ï¼š`separate`

**å­—æ®µé…ç½®**ï¼š
- **è§†é¢‘æ ‡é¢˜**ï¼š
  - å¯ç”¨ï¼šâœ…
  - æœ€å¤§é•¿åº¦ï¼š80å­—

- **ç®€ä»‹**ï¼š
  - å¯ç”¨ï¼šâœ…
  - æœ€å¤§é•¿åº¦ï¼š2000å­—
  - æ”¯æŒè¯é¢˜æ ‡ç­¾ï¼šâŒ
  - æ”¯æŒæ¢è¡Œï¼šâœ…

- **æ ‡ç­¾**ï¼š
  - ç‹¬ç«‹å­—æ®µï¼šâœ…
  - æœ€å¤§æ•°é‡ï¼š12ä¸ª

**æ ¼å¼åŒ–è§„åˆ™**ï¼š
```
æ ‡é¢˜ â†’ æ ‡é¢˜å­—æ®µ
æè¿° â†’ ç®€ä»‹å­—æ®µ
[æ ‡ç­¾1, æ ‡ç­¾2, æ ‡ç­¾3] â†’ æ ‡ç­¾å­—æ®µ (æ•°ç»„)
```

---

#### è§†é¢‘å· (Channels)

**å¸ƒå±€ç±»å‹**ï¼š`title-combined`

**å­—æ®µé…ç½®**ï¼š
- **æè¿°**ï¼š
  - å¯ç”¨ï¼šâœ…
  - åŒ…å«æè¿°ï¼šâœ…
  - åŒ…å«æ ‡ç­¾ï¼šâœ…
  - åŒ…å«æ ‡é¢˜ï¼šâŒ
  - å ä½ç¬¦ï¼š"è¯´ç‚¹ä»€ä¹ˆ...#è¯é¢˜"

**æ ¼å¼åŒ–è§„åˆ™**ï¼š
```
æè¿°

#æ ‡ç­¾1 #æ ‡ç­¾2
```
**æ³¨æ„**ï¼šè§†é¢‘å·æ²¡æœ‰ç‹¬ç«‹çš„æ ‡é¢˜å­—æ®µï¼

---

## 4. å¹³å°é€‚é…å™¨API

### 4.1 æ ¸å¿ƒæ–¹æ³•

#### format()
```typescript
PlatformMetadataAdapter.format(
    platform: PlatformKey,
    metadata: MaterialMetadata
): {
    title?: string
    description?: string
    tags?: string[]
    combinedContent?: string
}
```

**åŠŸèƒ½**ï¼šå°†é€šç”¨å…ƒæ•°æ®æ ¼å¼åŒ–ä¸ºå¹³å°ç‰¹å®šæ ¼å¼

**ç¤ºä¾‹**ï¼š
```typescript
const input = {
    title: "ç²¾å½©ç¬é—´",
    description: "åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½",
    tags: ["ç”Ÿæ´»", "vlog", "æ—¥å¸¸"]
}

// æŠ–éŸ³
const douyin = PlatformMetadataAdapter.format("douyin", input)
// {
//     title: "ç²¾å½©ç¬é—´",
//     description: "åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½\n\n#ç”Ÿæ´» #vlog #æ—¥å¸¸"
// }

// å¿«æ‰‹
const kuaishou = PlatformMetadataAdapter.format("kuaishou", input)
// {
//     combinedContent: "ç²¾å½©ç¬é—´\n\nåˆ†äº«ç”Ÿæ´»çš„ç¾å¥½\n\n#ç”Ÿæ´» #vlog #æ—¥å¸¸"
// }

// Bç«™
const bilibili = PlatformMetadataAdapter.format("bilibili", input)
// {
//     title: "ç²¾å½©ç¬é—´",
//     description: "åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½",
//     tags: ["ç”Ÿæ´»", "vlog", "æ—¥å¸¸"]
// }
```

#### validate()
```typescript
PlatformMetadataAdapter.validate(
    platform: PlatformKey,
    metadata: MaterialMetadata
): { valid: boolean; errors: string[] }
```

**åŠŸèƒ½**ï¼šéªŒè¯å…ƒæ•°æ®æ˜¯å¦ç¬¦åˆå¹³å°è¦æ±‚

**ç¤ºä¾‹**ï¼š
```typescript
const result = PlatformMetadataAdapter.validate("xiaohongshu", {
    title: "è¿™æ˜¯ä¸€ä¸ªè¶…è¿‡äºŒåä¸ªå­—çš„æ ‡é¢˜å†…å®¹",
    description: "æè¿°",
    tags: []
})
// {
//     valid: false,
//     errors: ["æ ‡é¢˜è¶…å‡ºæœ€å¤§é•¿åº¦é™åˆ¶ (20å­—)"]
// }
```

#### getExample()
```typescript
PlatformMetadataAdapter.getExample(platform: PlatformKey): MaterialMetadata
```

**åŠŸèƒ½**ï¼šè·å–å¹³å°å…ƒæ•°æ®ç¤ºä¾‹

---

## 5. å…ƒæ•°æ®ç¼–è¾‘å™¨å¢å¼º

### 5.1 æ–°å¢åŠŸèƒ½

#### å¹³å°é¢„è§ˆæ ‡ç­¾é¡µ
- **ä½ç½®**ï¼šç¼–è¾‘å™¨å³ä¾§ï¼Œæ ‡ç­¾ç®¡ç†åŒºåŸŸä¸‹æ–¹
- **æ˜¾ç¤ºæ¡ä»¶**ï¼šç”¨æˆ·é€‰æ‹©äº†å‘å¸ƒå¹³å°æ—¶è‡ªåŠ¨æ˜¾ç¤º
- **åŠŸèƒ½**ï¼š
  1. å¤šå¹³å°æ ‡ç­¾é¡µåˆ‡æ¢
  2. å®æ—¶é¢„è§ˆæ ¼å¼åŒ–åçš„å†…å®¹
  3. æ˜¾ç¤ºå¹³å°å­—æ®µæ ‡ç­¾
  4. æç¤ºä¿¡æ¯è¯´æ˜

#### é¢„è§ˆå†…å®¹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¹³å°å‘å¸ƒé¢„è§ˆ             ğŸ‘ï¸     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [æŠ–éŸ³] [å¿«æ‰‹] [å°çº¢ä¹¦]...       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŠ–éŸ³å‘å¸ƒæ ¼å¼    [æ ‡é¢˜+æè¿°]     â”‚
â”‚                                 â”‚
â”‚ æ ‡é¢˜                            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ç²¾å½©ç¬é—´                    â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â”‚ ç®€ä»‹æè¿°                        â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½              â”‚â”‚
â”‚ â”‚                             â”‚â”‚
â”‚ â”‚ #ç”Ÿæ´» #vlog #æ—¥å¸¸           â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                 â”‚
â”‚ â„¹ï¸  æ ‡ç­¾å°†è‡ªåŠ¨æ·»åŠ  # ç¬¦å·å¹¶     â”‚
â”‚    é™„åŠ åˆ°æè¿°æœ«å°¾               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Props æ›´æ–°

```typescript
interface MaterialMetadataEditorProps {
    material: Material
    metadata: MaterialMetadata
    selectedPlatforms?: PlatformKey[]  // ğŸ†• æ–°å¢
    onSave: (metadata: MaterialMetadata) => void
    onClose: () => void
    onAIGenerate?: (materialId: string) => Promise<void>
}
```

---

## 6. å‘å¸ƒé€»è¾‘é›†æˆ

### 6.1 å•å¹³å°å‘å¸ƒ

```typescript
if (plan.platforms.length === 1) {
    const formatted = PlatformMetadataAdapter.format(
        plan.platforms[0],
        rawMetadata
    )

    return {
        file_id: m.id,
        title: formatted.title || rawMetadata.title,
        description: formatted.description || formatted.combinedContent,
        topics: formatted.tags || rawMetadata.tags
    }
}
```

### 6.2 å¤šå¹³å°å‘å¸ƒ

```typescript
// ä¿ç•™åŸå§‹æ ¼å¼ï¼Œè®©åç«¯æ ¹æ®å„è‡ªå¹³å°å¤„ç†
return {
    file_id: m.id,
    title: rawMetadata.title,
    description: rawMetadata.description,
    topics: rawMetadata.tags
}
```

**æ³¨æ„**ï¼šå¤šå¹³å°å‘å¸ƒæ—¶ï¼Œåç«¯éœ€è¦ä¸ºæ¯ä¸ªå¹³å°å•ç‹¬è°ƒç”¨é€‚é…å™¨

---

## 7. ä½¿ç”¨æµç¨‹

### 7.1 å®Œæ•´å·¥ä½œæµ

```
1. ç”¨æˆ·é€‰æ‹©å‘å¸ƒå¹³å°
   â”œâ”€ æŠ–éŸ³ âœ…
   â”œâ”€ å¿«æ‰‹ âœ…
   â””â”€ å°çº¢ä¹¦ âœ…
   â†“

2. æ·»åŠ ç´ æå¹¶ç‚¹å‡»ç¼–è¾‘
   â†“

3. åœ¨ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹
   â”œâ”€ æ ‡é¢˜ï¼š"ç²¾å½©ç¬é—´"
   â”œâ”€ æè¿°ï¼š"åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½"
   â””â”€ æ ‡ç­¾ï¼š[ç”Ÿæ´», vlog, æ—¥å¸¸]
   â†“

4. æŸ¥çœ‹å¹³å°é¢„è§ˆ
   â”œâ”€ [æŠ–éŸ³] æ ‡ç­¾é¡µ
   â”‚   â”œâ”€ æ ‡é¢˜ï¼š"ç²¾å½©ç¬é—´"
   â”‚   â””â”€ ç®€ä»‹ï¼š"åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½\n\n#ç”Ÿæ´» #vlog #æ—¥å¸¸"
   â”‚
   â”œâ”€ [å¿«æ‰‹] æ ‡ç­¾é¡µ
   â”‚   â””â”€ æè¿°ï¼š"ç²¾å½©ç¬é—´\n\nåˆ†äº«ç”Ÿæ´»çš„ç¾å¥½\n\n#ç”Ÿæ´» #vlog #æ—¥å¸¸"
   â”‚
   â””â”€ [å°çº¢ä¹¦] æ ‡ç­¾é¡µ
       â”œâ”€ æ ‡é¢˜ï¼š"ç²¾å½©ç¬é—´"
       â””â”€ æ­£æ–‡ï¼š"åˆ†äº«ç”Ÿæ´»çš„ç¾å¥½\n\n#ç”Ÿæ´»# #vlog# #æ—¥å¸¸#"
   â†“

5. ä¿å­˜å¹¶å‘å¸ƒ
   â””â”€ ç³»ç»Ÿè‡ªåŠ¨ä¸ºæ¯ä¸ªå¹³å°æ ¼å¼åŒ–å†…å®¹
```

### 7.2 å®é™…æ¡ˆä¾‹

#### æ¡ˆä¾‹1ï¼šåŒæ—¶å‘å¸ƒåˆ°æŠ–éŸ³å’Œå¿«æ‰‹

**è¾“å…¥**ï¼š
```typescript
{
    title: "ä»Šå¤©çš„ç”Ÿæ´»å¤ªç²¾å½©äº†",
    description: "å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ä»Šå¤©å‘ç”Ÿçš„æœ‰è¶£äº‹æƒ…",
    tags: ["ç”Ÿæ´»", "åˆ†äº«", "å¿«ä¹"]
}
```

**æŠ–éŸ³æ ¼å¼åŒ–ç»“æœ**ï¼š
```
æ ‡é¢˜å­—æ®µï¼šä»Šå¤©çš„ç”Ÿæ´»å¤ªç²¾å½©äº†
ç®€ä»‹å­—æ®µï¼šå’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ä»Šå¤©å‘ç”Ÿçš„æœ‰è¶£äº‹æƒ…

#ç”Ÿæ´» #åˆ†äº« #å¿«ä¹
```

**å¿«æ‰‹æ ¼å¼åŒ–ç»“æœ**ï¼š
```
æè¿°å­—æ®µï¼šä»Šå¤©çš„ç”Ÿæ´»å¤ªç²¾å½©äº†

å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ä»Šå¤©å‘ç”Ÿçš„æœ‰è¶£äº‹æƒ…

#ç”Ÿæ´» #åˆ†äº« #å¿«ä¹
```

---

## 8. æŠ€æœ¯å®ç°ç»†èŠ‚

### 8.1 æ ‡ç­¾å¤„ç†

#### è‡ªåŠ¨æ·»åŠ  # ç¬¦å·
```typescript
const hashtagsText = tags.map(tag => {
    return tag.startsWith('#') ? tag : `#${tag}`
}).join(' ')
```

#### å»é‡é€»è¾‘
```typescript
if (!result.includes(hashtagsText)) {
    result = `${result}\n\n${hashtagsText}`
}
```

### 8.2 æ–‡æœ¬æˆªæ–­

```typescript
private static truncate(text: string, maxLength?: number): string {
    if (!maxLength || text.length <= maxLength) {
        return text
    }
    return text.substring(0, maxLength)
}
```

### 8.3 å†…å®¹åˆå¹¶ç­–ç•¥

```typescript
private static combineAll(title: string, description: string, tags: string[]): string {
    const parts: string[] = []

    if (title && title.trim()) {
        parts.push(title.trim())
    }

    if (description && description.trim()) {
        parts.push(description.trim())
    }

    if (tags && tags.length > 0) {
        const hashtagsText = tags.map(tag =>
            tag.startsWith('#') ? tag : `#${tag}`
        ).join(' ')
        parts.push(hashtagsText)
    }

    return parts.join('\n\n')  // ä½¿ç”¨åŒæ¢è¡Œåˆ†éš”
}
```

---

## 9. æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
- âœ… `/lib/platform-metadata-adapter.ts` - å¹³å°é€‚é…å™¨å¼•æ“

### ä¿®æ”¹æ–‡ä»¶
- âœ… `/components/MaterialMetadataEditor.tsx` - æ·»åŠ å¹³å°é¢„è§ˆ
- âœ… `/campaigns/publish/matrix/page.tsx` - é›†æˆé€‚é…å™¨é€»è¾‘
- âœ… `next.config.ts` - å›¾ç‰‡åŸŸåé…ç½®

---

## 10. æµ‹è¯•è¦ç‚¹

### 10.1 å•å…ƒæµ‹è¯•

```typescript
describe('PlatformMetadataAdapter', () => {
    test('æŠ–éŸ³æ ¼å¼åŒ–', () => {
        const result = PlatformMetadataAdapter.format('douyin', {
            title: 'æ ‡é¢˜',
            description: 'æè¿°',
            tags: ['æ ‡ç­¾1', 'æ ‡ç­¾2']
        })

        expect(result.title).toBe('æ ‡é¢˜')
        expect(result.description).toContain('#æ ‡ç­¾1')
        expect(result.description).toContain('#æ ‡ç­¾2')
    })

    test('å¿«æ‰‹æ ¼å¼åŒ–', () => {
        const result = PlatformMetadataAdapter.format('kuaishou', {
            title: 'æ ‡é¢˜',
            description: 'æè¿°',
            tags: ['æ ‡ç­¾1']
        })

        expect(result.combinedContent).toContain('æ ‡é¢˜')
        expect(result.combinedContent).toContain('æè¿°')
        expect(result.combinedContent).toContain('#æ ‡ç­¾1')
    })
})
```

### 10.2 é›†æˆæµ‹è¯•

- [ ] é€‰æ‹©å•ä¸ªå¹³å°å‘å¸ƒ
- [ ] æŸ¥çœ‹é¢„è§ˆæ˜¯å¦æ­£ç¡®
- [ ] ä¿å­˜åæ•°æ®æ˜¯å¦æ­£ç¡®æ ¼å¼åŒ–
- [ ] é€‰æ‹©å¤šä¸ªå¹³å°å‘å¸ƒ
- [ ] åˆ‡æ¢å¹³å°æ ‡ç­¾é¡µ
- [ ] éªŒè¯ä¸åŒå¹³å°çš„æ ¼å¼å·®å¼‚

### 10.3 è¾¹ç•Œæµ‹è¯•

- [ ] è¶…é•¿æ ‡é¢˜ï¼ˆå°çº¢ä¹¦20å­—é™åˆ¶ï¼‰
- [ ] ç©ºæ ‡é¢˜/æè¿°/æ ‡ç­¾
- [ ] æ ‡ç­¾å·²åŒ…å« # ç¬¦å·
- [ ] ç‰¹æ®Šå­—ç¬¦å¤„ç†
- [ ] æ¢è¡Œç¬¦å¤„ç†

---

## 11. æ€§èƒ½ä¼˜åŒ–

### 11.1 useMemo ä¼˜åŒ–

```typescript
const platformPreviews = useMemo(() => {
    return selectedPlatforms.map(platform => {
        const formatted = PlatformMetadataAdapter.format(platform, localMetadata)
        return { platform, formatted, config: PLATFORM_CONFIGS[platform] }
    })
}, [selectedPlatforms, localMetadata])
```

### 11.2 æ‡’åŠ è½½ç­–ç•¥

```typescript
{/* åªæœ‰é€‰æ‹©äº†å¹³å°æ‰æ¸²æŸ“é¢„è§ˆ */}
{selectedPlatforms.length > 0 && (
    <PlatformPreviewTabs />
)}
```

---

## 12. åç«¯é€‚é…å»ºè®®

### 12.1 åç«¯æ•°æ®ç»“æ„

```python
@dataclass
class PlatformMetadata:
    platform_code: int
    title: Optional[str]
    description: Optional[str]
    tags: List[str]
    combined_content: Optional[str]  # ç”¨äºå¿«æ‰‹ã€è§†é¢‘å·
```

### 12.2 åç«¯é€‚é…å™¨

```python
class PlatformMetadataAdapter:
    @staticmethod
    def format_for_platform(platform_code: int, metadata: dict) -> dict:
        if platform_code == 3:  # æŠ–éŸ³
            return {
                "title": metadata.get("title"),
                "description": merge_description_and_tags(
                    metadata.get("description"),
                    metadata.get("tags")
                )
            }
        elif platform_code == 4:  # å¿«æ‰‹
            return {
                "combined_content": combine_all(
                    metadata.get("title"),
                    metadata.get("description"),
                    metadata.get("tags")
                )
            }
        # ... å…¶ä»–å¹³å°
```

---

## 13. å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæœ‰äº›å¹³å°ä¸æ”¯æŒç‹¬ç«‹æ ‡é¢˜ï¼Ÿ
A: è§†é¢‘å·ç­‰å¹³å°çš„è®¾è®¡ç†å¿µæ˜¯ä»¥å†…å®¹ä¸ºä¸­å¿ƒï¼Œä¸å¼ºè°ƒæ ‡é¢˜ã€‚ç”¨æˆ·å¯ä»¥åœ¨æè¿°ä¸­è‡ªç„¶åœ°è¡¨è¾¾é‡ç‚¹ã€‚

### Q2: æ ‡ç­¾çš„ # ç¬¦å·ä¼šé‡å¤æ·»åŠ å—ï¼Ÿ
A: ä¸ä¼šã€‚é€‚é…å™¨ä¼šå…ˆæ£€æŸ¥æ ‡ç­¾æ˜¯å¦å·²ç»åŒ…å« #ï¼Œé¿å…é‡å¤ã€‚

### Q3: å¤šå¹³å°å‘å¸ƒæ—¶å¦‚ä½•å¤„ç†ï¼Ÿ
A: å‰ç«¯ä¿ç•™åŸå§‹æ ¼å¼ä¼ ç»™åç«¯ï¼Œåç«¯æ ¹æ®æ¯ä¸ªå¹³å°çš„è´¦å·æ‰€å±å¹³å°å•ç‹¬æ ¼å¼åŒ–ã€‚

### Q4: å¦‚ä½•æµ‹è¯•å¹³å°é¢„è§ˆåŠŸèƒ½ï¼Ÿ
A:
1. é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªå¹³å°
2. æ·»åŠ ç´ æå¹¶ç‚¹å‡»ç¼–è¾‘
3. è¾“å…¥å†…å®¹åå‘ä¸‹æ»šåŠ¨æŸ¥çœ‹"å¹³å°å‘å¸ƒé¢„è§ˆ"åŒºåŸŸ
4. åˆ‡æ¢å¹³å°æ ‡ç­¾é¡µæŸ¥çœ‹ä¸åŒæ ¼å¼

---

## 14. æœªæ¥ä¼˜åŒ–æ–¹å‘

### 14.1 çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2å‘¨ï¼‰
- [ ] æ·»åŠ å¹³å°æ ¼å¼åŒ–è§„åˆ™çš„å¯è§†åŒ–è¯´æ˜
- [ ] æ”¯æŒè‡ªå®šä¹‰æ ¼å¼åŒ–è§„åˆ™
- [ ] æ·»åŠ æ ¼å¼éªŒè¯é”™è¯¯æç¤º

### 14.2 ä¸­æœŸä¼˜åŒ–ï¼ˆ1-2æœˆï¼‰
- [ ] æ”¯æŒå¹³å°ä¸“å±å­—æ®µï¼ˆå¦‚æŠ–éŸ³çš„åˆæ‹ã€Bç«™çš„åˆ†åŒºï¼‰
- [ ] æ·»åŠ æ ¼å¼åŒ–æ¨¡æ¿ç³»ç»Ÿ
- [ ] å†å²æ ¼å¼è®°å½•å’Œå›é€€

### 14.3 é•¿æœŸä¼˜åŒ–ï¼ˆ3æœˆ+ï¼‰
- [ ] AI æ™ºèƒ½æ¨èå¹³å°æœ€ä½³æ ¼å¼
- [ ] åŸºäºå†å²æ•°æ®çš„æ ¼å¼ä¼˜åŒ–å»ºè®®
- [ ] è·¨å¹³å°å†…å®¹æ•ˆæœåˆ†æ

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**æ›´æ–°æ—¥æœŸ**ï¼š2025-12-03
**ç»´æŠ¤è€…**ï¼šClaude Code Assistant
