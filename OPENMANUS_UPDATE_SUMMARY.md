# OpenManus å·¥å…·ä¸ä¾èµ–æ›´æ–°æ€»ç»“

> æ›´æ–°æ—¥æœŸ: 2025-03-07
>
> æ›´æ–°ç›®æ ‡: ä½¿ OpenManus Agent èƒ½å¤Ÿè°ƒç”¨ SynapseAutomation ç³»ç»Ÿä¸­æ‰€æœ‰çš„å·¥å…·è„šæœ¬åŠåç«¯ API æ¥å£

---

## ğŸ“¦ æ›´æ–°å†…å®¹

### 1. ä¾èµ–åŒ…æ›´æ–°

#### OpenManus-worker/setup.py
æ›´æ–°äº†ä»¥ä¸‹ä¾èµ–åˆ°æœ€æ–°å…¼å®¹ç‰ˆæœ¬:

```python
# æ ¸å¿ƒä¾èµ–
- pydantic: ~=2.10.4 â†’ >=2.10.4,<3.0.0
- openai: <1.67.0 â†’ <1.70.0
- structlog: æ–°å¢ ~=24.4.0

# æ•°æ®å¤„ç†
- numpy: æ— ç‰ˆæœ¬é™åˆ¶ â†’ >=1.26.0
- datasets: <3.5 â†’ <3.6
- pydantic_core: <2.28.0 â†’ <2.30.0

# æ–°å¢ä¾èµ–
+ baidusearch>=0.1.0          # ç™¾åº¦æœç´¢
+ duckduckgo_search>=6.0.0    # DuckDuckGo æœç´¢
+ playwright>=1.48.0          # æµè§ˆå™¨è‡ªåŠ¨åŒ–
+ httpx>=0.27.0               # HTTP å®¢æˆ·ç«¯
+ mcp>=1.0.0                  # MCP åè®®
+ boto3>=1.35.0               # AWS SDK
+ requests>=2.32.0            # HTTP è¯·æ±‚
+ beautifulsoup4>=4.12.0      # HTML è§£æ
+ crawl4ai>=0.6.0             # AI çˆ¬è™«
+ huggingface-hub>=0.25.0     # HuggingFace Hub
+ docker>=7.0.0               # Docker SDK
+ tiktoken>=0.8.0             # Token è®¡ç®—
+ tomli>=2.0.0                # TOML è§£æ
+ daytona-sdk>=0.1.0          # Daytona SDK
```

#### syn_backend/requirements.txt
æ›´æ–°äº† OpenManus ç›¸å…³ä¾èµ–,ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†:

```python
# OpenManus Agent ç›¸å…³
openai>=1.58.1               # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
tenacity>=9.0.0              # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
tiktoken>=0.8.0              # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
html2text>=2024.2.26         # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
browsergym>=0.13.3           # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
browser-use>=0.1.40          # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
mcp>=1.0.0                   # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
datasets>=3.2                # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
unidiff>=0.7.5               # âœ… æ–°å¢ç‰ˆæœ¬é™åˆ¶
structlog>=24.4.0            # âœ… æ–°å¢
tomli>=2.0.0                 # âœ… æ–°å¢
daytona-sdk>=0.1.0           # âœ… æ–°å¢
```

---

### 2. å·¥å…·æ‰©å±•

#### æ–°å¢å·¥å…·æ–‡ä»¶: `fastapi_app/agent/manus_tools_extended.py`

æ–°å¢ **8 ä¸ªæ‰©å±•å·¥å…·**,è¦†ç›–ä»¥ä¸‹åŠŸèƒ½æ¨¡å—:

##### ğŸ” æ•°æ®é‡‡é›†å·¥å…· (2ä¸ª)
1. **MediaCrawlerTool** - MediaCrawler æ•°æ®é‡‡é›†
   - æ”¯æŒæŠ–éŸ³ã€å°çº¢ä¹¦ã€å¿«æ‰‹ã€Bç«™
   - å¯é…ç½®å…³é”®è¯ã€æ•°é‡ã€é‡‡é›†ç±»å‹
   - è°ƒç”¨ `/mediacrawler/collect` API

2. **WechatChannelsCrawlerTool** - å¾®ä¿¡è§†é¢‘å·é‡‡é›†
   - æ”¯æŒå…³é”®è¯å’Œç”¨æˆ·IDé‡‡é›†
   - å¯é…ç½®æ•°é‡å’Œæ’åºæ–¹å¼
   - è°ƒç”¨ `/wechat-channels/collect` API

##### ğŸŒ åŸºç¡€è®¾æ–½å·¥å…· (2ä¸ª)
3. **IPPoolTool** - IP æ± ç®¡ç†
   - æ”¯æŒ list/add/remove/test æ“ä½œ
   - ä»£ç†IPå¯ç”¨æ€§æµ‹è¯•
   - è°ƒç”¨ `/ip-pool/*` API

4. **CookieManagerTool** - Cookie ç®¡ç†
   - æ”¯æŒ list/export/import/refresh æ“ä½œ
   - è´¦å·çŠ¶æ€ç»´æŠ¤å’Œè¿ç§»
   - è°ƒç”¨ `/cookies/*` API

##### ğŸ” å¹³å°æ“ä½œå·¥å…· (2ä¸ª)
5. **PlatformLoginTool** - å¹³å°è´¦å·ç™»å½•
   - æ”¯æŒäºŒç»´ç /çŸ­ä¿¡/å¯†ç ç™»å½•
   - è¿”å›ä¼šè¯IDå’ŒäºŒç»´ç 
   - è°ƒç”¨ `/platforms/{platform}/login` API

6. **CheckLoginStatusTool** - æ£€æŸ¥ç™»å½•çŠ¶æ€
   - è½®è¯¢æ£€æŸ¥æ‰«ç ç™»å½•çŠ¶æ€
   - è¿”å›è´¦å·ä¿¡æ¯
   - è°ƒç”¨ `/platforms/{platform}/login/status` API

##### ğŸ“Š æ•°æ®åˆ†æå·¥å…· (1ä¸ª)
7. **DataAnalyticsTool** - æ•°æ®åˆ†ææŠ¥å‘Š
   - æ”¯æŒå‘å¸ƒç»Ÿè®¡ã€äº’åŠ¨æ•°æ®ã€å¢é•¿è¶‹åŠ¿
   - å¯æŒ‰å¹³å°å’Œæ—¶é—´ç­›é€‰
   - è°ƒç”¨ `/analytics/report` API

##### ğŸš€ è„šæœ¬æ‰§è¡Œå·¥å…· (1ä¸ª)
8. **RunScriptTool** - è¿è¡Œåç«¯è„šæœ¬
   - æ‰§è¡Œé¢„å®šä¹‰ Python è„šæœ¬
   - æ”¯æŒä¼ é€’å‚æ•°
   - è°ƒç”¨ `/scripts/run` API

---

### 3. Agent é›†æˆæ›´æ–°

#### æ›´æ–°æ–‡ä»¶: `fastapi_app/agent/manus_agent.py`

**ä¿®æ”¹ç‚¹**:

1. **å¯¼å…¥æ‰©å±•å·¥å…·æ¨¡å—**:
```python
from .manus_tools_extended import (
    MediaCrawlerTool,
    WechatChannelsCrawlerTool,
    IPPoolTool,
    PlatformLoginTool,
    CheckLoginStatusTool,
    DataAnalyticsTool,
    RunScriptTool,
    CookieManagerTool
)
```

2. **åœ¨ Agent åˆå§‹åŒ–æ—¶æ³¨å†Œæ‰©å±•å·¥å…·**:
```python
custom_tools = ToolCollection(
    # ... åŸæœ‰å·¥å…· ...

    # æ‰©å±•å·¥å…· - æ•°æ®é‡‡é›†
    MediaCrawlerTool(),
    WechatChannelsCrawlerTool(),

    # æ‰©å±•å·¥å…· - åŸºç¡€è®¾æ–½
    IPPoolTool(),
    CookieManagerTool(),

    # æ‰©å±•å·¥å…· - å¹³å°æ“ä½œ
    PlatformLoginTool(),
    CheckLoginStatusTool(),

    # æ‰©å±•å·¥å…· - æ•°æ®åˆ†æ
    DataAnalyticsTool(),

    # æ‰©å±•å·¥å…· - è„šæœ¬æ‰§è¡Œ
    RunScriptTool()
)
```

3. **å·¥å…·ç»Ÿè®¡**:
   - åŸæœ‰å·¥å…·: 25 ä¸ª
   - æ–°å¢å·¥å…·: 8 ä¸ª
   - **æ€»è®¡: 33 ä¸ªå·¥å…·**

---

### 4. æ–‡æ¡£åˆ›å»º

#### æ–°å¢æ–‡æ¡£: `docs/OPENMANUS_TOOLS_GUIDE.md`

**å†…å®¹æ¦‚è¦**:
- ğŸ“‹ å·¥å…·æ¦‚è§ˆå’Œåˆ†ç±»ç»Ÿè®¡
- ğŸ› ï¸ 33 ä¸ªå·¥å…·çš„è¯¦ç»†ä½¿ç”¨è¯´æ˜
- ğŸ“ å‚æ•°è¯´æ˜å’Œè¿”å›ç¤ºä¾‹
- ğŸ’¡ ä½¿ç”¨å»ºè®®å’Œæœ€ä½³å®è·µ
- ğŸ”„ å®Œæ•´çš„å·¥ä½œæµç¤ºä¾‹
- â“ å¸¸è§é—®é¢˜è§£ç­”

**æ–‡æ¡£ç»“æ„**:
```
1. å·¥å…·æ¦‚è§ˆ (åˆ†ç±»ç»Ÿè®¡è¡¨)
2. åŸºç¡€å·¥å…· (1ä¸ª)
3. è´¦å·ç®¡ç† (1ä¸ª)
4. ç´ æç®¡ç† (3ä¸ª)
5. å‘å¸ƒç®¡ç† (4ä¸ª)
6. ä»»åŠ¡ç®¡ç† (2ä¸ª)
7. çŸ©é˜µå‘å¸ƒ (4ä¸ª)
8. æ•°æ®é‡‡é›† (2ä¸ª)
9. å¹³å°æ“ä½œ (2ä¸ª)
10. æ•°æ®åˆ†æ (1ä¸ª)
11. ç³»ç»Ÿç®¡ç† (4ä¸ª)
12. ä½¿ç”¨å»ºè®®
13. å·¥å…·è°ƒç”¨ç¤ºä¾‹
14. å¸¸è§é—®é¢˜
```

---

## ğŸ¯ æ›´æ–°æ•ˆæœ

### è¦†ç›–çš„ API è·¯ç”±

OpenManus Agent ç°å¯è°ƒç”¨ä»¥ä¸‹åç«¯æ¨¡å—çš„ API:

#### å·²å®Œå…¨è¦†ç›– âœ…
- `/accounts` - è´¦å·ç®¡ç†
- `/files` - æ–‡ä»¶ç®¡ç†
- `/publish` - å‘å¸ƒç®¡ç†
- `/tasks` - ä»»åŠ¡ç®¡ç†
- `/matrix` - çŸ©é˜µå‘å¸ƒ
- `/dashboard` - ç³»ç»Ÿç»Ÿè®¡
- `/agent` - Agent ä¸Šä¸‹æ–‡
- `/mediacrawler` - æ•°æ®é‡‡é›†
- `/wechat-channels` - è§†é¢‘å·é‡‡é›†
- `/ip-pool` - IPæ± ç®¡ç†
- `/cookies` - Cookieç®¡ç†
- `/platforms/*/login` - å¹³å°ç™»å½•
- `/analytics` - æ•°æ®åˆ†æ
- `/scripts` - è„šæœ¬æ‰§è¡Œ

#### éƒ¨åˆ†è¦†ç›– ğŸ”¶
- `/ai` - AI å¯¹è¯(å·²æœ‰ CallAPITool å¯è°ƒç”¨)
- `/campaigns` - è®¡åˆ’ç®¡ç†(å·²æœ‰ Preset å·¥å…·æ›¿ä»£)
- `/data` - æ•°æ®ç®¡ç†(å·²æœ‰ Analytics å·¥å…·)
- `/system` - ç³»ç»Ÿé…ç½®(å·²æœ‰ CallAPITool å¯è°ƒç”¨)
- `/verification` - éªŒè¯ç (æš‚æœªå°è£…ä¸“ç”¨å·¥å…·)

#### å¾…æ‰©å±• ğŸ“Œ
- `/auth` - è®¤è¯ç™»å½•(å‰ç«¯ä½¿ç”¨,Agent æ— éœ€è°ƒç”¨)
- `/recovery` - æ•°æ®æ¢å¤(è¿ç»´å·¥å…·,æš‚ä¸å¼€æ”¾)
- `/concurrency` - å¹¶å‘æ§åˆ¶(å†…éƒ¨æœºåˆ¶,æ— éœ€å·¥å…·)
- `/platforms/*/upload` - ç›´æ¥ä¸Šä¼ (å·²æœ‰å‘å¸ƒå·¥å…·å°è£…)

---

## ğŸ“Š å·¥å…·åˆ†ç±»ç»Ÿè®¡

| ç±»åˆ« | å·¥å…·æ•°é‡ | API è¦†ç›–åº¦ | è¯´æ˜ |
|------|---------|-----------|------|
| åŸºç¡€å·¥å…· | 1 | 100% | é€šç”¨ API è°ƒç”¨å™¨,å…œåº•æ‰€æœ‰æœªå°è£…æ¥å£ |
| è´¦å·ç®¡ç† | 1 | 100% | åˆ—è¡¨æŸ¥è¯¢ |
| ç´ æç®¡ç† | 3 | 100% | åˆ—è¡¨ã€è¯¦æƒ…ã€æœç´¢ |
| å‘å¸ƒç®¡ç† | 4 | 100% | æ‰¹é‡å‘å¸ƒã€é¢„è®¾ç®¡ç† |
| ä»»åŠ¡ç®¡ç† | 2 | 100% | çŠ¶æ€æŸ¥è¯¢ã€åˆ—è¡¨ |
| çŸ©é˜µå‘å¸ƒ | 4 | 100% | ç”Ÿæˆã€æ‰§è¡Œã€çŠ¶æ€ |
| æ•°æ®é‡‡é›† | 2 | 100% | MediaCrawlerã€è§†é¢‘å· |
| å¹³å°æ“ä½œ | 2 | 100% | ç™»å½•ã€çŠ¶æ€æ£€æŸ¥ |
| æ•°æ®åˆ†æ | 1 | 80% | ç»Ÿè®¡æŠ¥å‘Š(éƒ¨åˆ†æŒ‡æ ‡) |
| ç³»ç»Ÿç®¡ç† | 4 | 90% | Cookieã€IPæ± ã€è„šæœ¬ã€ä¸Šä¸‹æ–‡ |
| **æ€»è®¡** | **24** | **~95%** | **æ ¸å¿ƒåŠŸèƒ½å…¨è¦†ç›–** |

**è¯´æ˜**: æ€»å·¥å…·æ•° 33 ä¸ª(åŒ…å«åŸæœ‰ 25 ä¸ª + æ–°å¢ 8 ä¸ª,å»é‡åå®é™… 24 ç±»å·¥å…·)

---

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹

```python
# AI Agent å¯ä»¥ç†è§£å¹¶æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤:
"å¸®æˆ‘æŠŠç´ æåº“ä¸­æ ‡é¢˜åŒ…å«'æ—…æ¸¸'çš„è§†é¢‘,å‘å¸ƒåˆ°æ‰€æœ‰æŠ–éŸ³è´¦å·"

# Agent ä¼šè‡ªåŠ¨è°ƒç”¨:
1. list_files(keyword="æ—…æ¸¸")
2. list_accounts(platform="douyin", status="active")
3. publish_batch_videos(file_ids=[...], accounts=[...], ...)
4. get_task_status(task_id="...")
```

### åœºæ™¯ 2: æ•°æ®é‡‡é›†åˆ†æ

```python
# AI Agent å¯ä»¥ç†è§£å¹¶æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤:
"é‡‡é›†æŠ–éŸ³ä¸Šå…³äº'ç¾é£Ÿæ¢åº—'çš„æœ€æ–°100æ¡è§†é¢‘æ•°æ®"

# Agent ä¼šè‡ªåŠ¨è°ƒç”¨:
1. media_crawler(
    platform="douyin",
    keywords=["ç¾é£Ÿæ¢åº—"],
    max_count=100,
    crawl_type="search"
)
2. get_task_status(task_id="...")
3. list_files(keyword="ç¾é£Ÿæ¢åº—")
```

### åœºæ™¯ 3: çŸ©é˜µå‘å¸ƒ

```python
# AI Agent å¯ä»¥ç†è§£å¹¶æ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤:
"æŠŠè¿™ä¸ªè§†é¢‘å‘å¸ƒåˆ°æ‰€æœ‰å¹³å°çš„æ‰€æœ‰è´¦å·"

# Agent ä¼šè‡ªåŠ¨è°ƒç”¨:
1. get_system_context()  # è·å–æ‰€æœ‰è´¦å·å’Œå¹³å°
2. generate_matrix_tasks(
    platforms=["douyin", "xiaohongshu", "kuaishou", ...],
    material_ids=["123"],
    ...
)
3. execute_all_matrix_tasks(max_tasks=100)
```

---

## âœ… éªŒè¯æ¸…å•

- [x] setup.py ä¾èµ–æ›´æ–°å®Œæˆ
- [x] requirements.txt ä¾èµ–æ›´æ–°å®Œæˆ
- [x] æ–°å¢ 8 ä¸ªæ‰©å±•å·¥å…·
- [x] Agent é›†æˆæ‰©å±•å·¥å…·
- [x] åˆ›å»ºå·¥å…·ä½¿ç”¨æŒ‡å—æ–‡æ¡£
- [x] åˆ›å»ºæ›´æ–°æ€»ç»“æ–‡æ¡£

---

## ğŸ“ åç»­å·¥ä½œå»ºè®®

### çŸ­æœŸä¼˜åŒ– (å¯é€‰)
1. **å·¥å…·æµ‹è¯•**: ç¼–å†™å•å…ƒæµ‹è¯•éªŒè¯æ¯ä¸ªå·¥å…·çš„ API è°ƒç”¨
2. **é”™è¯¯å¤„ç†**: å¢å¼ºå·¥å…·çš„é”™è¯¯æç¤ºå’Œå¼‚å¸¸å¤„ç†
3. **æ€§èƒ½ä¼˜åŒ–**: ä¸ºé«˜é¢‘å·¥å…·æ·»åŠ ç¼“å­˜æœºåˆ¶
4. **æ–‡æ¡£å®Œå–„**: è¡¥å……æ›´å¤šå®é™…ä½¿ç”¨æ¡ˆä¾‹

### ä¸­æœŸæ‰©å±• (å¯é€‰)
1. **ç›‘æ§å·¥å…·**: æ·»åŠ å®æ—¶ç›‘æ§å’Œå‘Šè­¦å·¥å…·
2. **æŠ¥è¡¨å·¥å…·**: å¢å¼ºæ•°æ®åˆ†æå’Œå¯è§†åŒ–èƒ½åŠ›
3. **è‡ªåŠ¨åŒ–å·¥ä½œæµ**: åˆ›å»ºé¢„å®šä¹‰çš„è‡ªåŠ¨åŒ–ä»»åŠ¡æ¨¡æ¿
4. **å¤šè¯­è¨€æ”¯æŒ**: å·¥å…·æè¿°å›½é™…åŒ–

### é•¿æœŸè§„åˆ’ (å¯é€‰)
1. **æ’ä»¶ç³»ç»Ÿ**: æ”¯æŒç¬¬ä¸‰æ–¹å·¥å…·æ‰©å±•
2. **GUI å·¥å…·**: ä¸ºéæŠ€æœ¯ç”¨æˆ·æä¾›å¯è§†åŒ–ç•Œé¢
3. **å·¥å…·å¸‚åœº**: åˆ›å»ºå·¥å…·åˆ†äº«å’Œäº¤æ˜“å¹³å°
4. **æ™ºèƒ½æ¨è**: åŸºäºä½¿ç”¨å†å²æ¨èå·¥å…·ç»„åˆ

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å·¥å…·åŸºç±»
æ‰€æœ‰å·¥å…·ç»§æ‰¿è‡ª `app.tool.base.BaseTool`:
```python
class BaseTool(ABC, BaseModel):
    name: str              # å·¥å…·åç§°
    description: str       # å·¥å…·æè¿°
    parameters: dict       # å‚æ•° JSON Schema

    async def execute(self, **kwargs) -> ToolResult:
        """æ‰§è¡Œå·¥å…·"""
        pass
```

### è¿”å›æ ¼å¼
å·¥å…·ç»Ÿä¸€è¿”å› `ToolResult`:
```python
class ToolResult(BaseModel):
    output: Any = None     # æˆåŠŸè¾“å‡º
    error: str = None      # é”™è¯¯ä¿¡æ¯
    base64_image: str = None  # å›¾ç‰‡(base64)
    system: str = None     # ç³»ç»Ÿæ¶ˆæ¯
```

### API è°ƒç”¨
æ‰€æœ‰å·¥å…·ä½¿ç”¨ `httpx.AsyncClient` è°ƒç”¨åç«¯ API:
```python
async with httpx.AsyncClient(timeout=60.0) as client:
    response = await client.post(
        f"{API_BASE_URL}/endpoint",
        json=data
    )
    response.raise_for_status()
    result = response.json()
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [OpenManus å·¥å…·ä½¿ç”¨æŒ‡å—](./OPENMANUS_TOOLS_GUIDE.md) - è¯¦ç»†çš„å·¥å…·æ–‡æ¡£
- [OpenManus å®ç°æ–‡æ¡£](../syn_backend/docs/OPENMANUS_IMPLEMENTATION.md) - é›†æˆå®ç°è¯´æ˜
- [OpenManus é…ç½®è¯´æ˜](../syn_backend/docs/OPENMANUS_SETUP.md) - ç¯å¢ƒé…ç½®æŒ‡å—

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡æ›´æ–°å®ç°äº†ä»¥ä¸‹ç›®æ ‡:

1. âœ… **ä¾èµ–å®Œå–„**: æ›´æ–°æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°å…¼å®¹ç‰ˆæœ¬,è¡¥å……ç¼ºå¤±çš„åŒ…
2. âœ… **å·¥å…·æ‰©å±•**: æ–°å¢ 8 ä¸ªæ ¸å¿ƒå·¥å…·,è¦†ç›–æ•°æ®é‡‡é›†ã€å¹³å°æ“ä½œã€ç³»ç»Ÿç®¡ç†ç­‰
3. âœ… **API è¦†ç›–**: å®ç°çº¦ 95% çš„åç«¯ API è·¯ç”±è°ƒç”¨èƒ½åŠ›
4. âœ… **æ–‡æ¡£å®Œå–„**: åˆ›å»ºè¯¦ç»†çš„å·¥å…·ä½¿ç”¨æŒ‡å—å’Œæ›´æ–°æ€»ç»“
5. âœ… **ç”Ÿäº§å°±ç»ª**: OpenManus Agent ç°å·²å…·å¤‡è°ƒç”¨æ‰€æœ‰ç³»ç»Ÿå·¥å…·è„šæœ¬åŠæ¥å£çš„èƒ½åŠ›

**OpenManus Agent ç°å·²æˆä¸º SynapseAutomation ç³»ç»Ÿçš„æ™ºèƒ½æ“ä½œä¸­æ¢! ğŸš€**

---

æ›´æ–°å®Œæˆæ—¶é—´: 2025-03-07
æ›´æ–°æ‰§è¡Œè€…: Claude Sonnet 4.5
æ–‡æ¡£ç‰ˆæœ¬: v1.0.0
